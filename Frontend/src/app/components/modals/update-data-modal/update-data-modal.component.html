<div class="w-full min-h-screen relative flex items-center justify-center">
    <div (click)="ocult()" class="w-full min-h-screen absolute bg-black opacity-30" style="z-index: 60;"></div>
    <div class="absolute m-auto bg-white rounded-xl min_oculy:w-1/2 w-11/12" style="z-index: 70;">
        <div class="relative bg-white rounded-lg shadow">
            <!-- Modal header -->
            <div class="flex items-center justify-between p-4 md:p-5 border-b-4 border-firstColor rounded-t">
                <h3 class="text-4xl font-bold text-firstColor">
                    @if (customer.showUpdateData) {Actualizar datos} 
                    @if (customer.showUpdatePassword) {Actualizar contraseña}
                    @if (customer.showAddCard) {Añadir tarjeta}
                </h3>
                <button (click)="ocult()" type="button"
                    class="end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-base w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white">
                    <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 14 14">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
                    </svg>
                    <span class="sr-only">Close modal</span>
                </button>
            </div>
            <!-- Modal body -->
            @if (customer.showUpdateData) {
                <form class="p-4 md:p-5" novalidate [formGroup]="formData">
                    <div class="grid gap-4 mb-4 grid-cols-2">
                        <div class="relative">
                            <label  
                                class="block mb-2 text-base font-medium text-gray-900">Primer Nombre</label>
                            <img class="absolute left-2 top-10 w-6" src="../../../../assets/resources/Recurso 29.png" alt="">
                            <input type="text" formControlName="firstName"
                                class="pl-10 bg-gray-50 border border-firstColor text-gray-900 text-base rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                                placeholder="Primer Nombre">
                                @if (authenticate.setError(formData.value.firstName, '') !== '' && formData.value.firstName !== '') {
                                    <p class="font-medium my-1 text-red-700" [innerHTML]="authenticate.setError(formData.value.firstName, '')"></p>
                                }
                        </div>
                        <div class="relative">
                            <label  
                                class="block mb-2 text-base font-medium text-gray-900">Segundo Nombre</label>
                            <img class="absolute left-2 top-10 w-6" src="../../../../assets/resources/Recurso 29.png" alt="">
                            <input type="text" formControlName="secondName"
                                class="pl-10 bg-gray-50 border border-firstColor text-gray-900 text-base rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                                placeholder="Segundo Nombre">
                                @if (authenticate.setError(formData.value.secondName, '') !== '' && formData.value.secondName !== '') {
                                    <p class="font-medium my-1 text-red-700" [innerHTML]="authenticate.setError(formData.value.secondName, '')"></p>
                                }
                        </div>
                        <div class="relative">
                            <label  
                                class="block mb-2 text-base font-medium text-gray-900">Primer Apellido</label>
                            <img class="absolute left-2 top-10 w-6" src="../../../../assets/resources/Recurso 29.png" alt="">
                            <input type="text" formControlName="firstLastName"
                                class="pl-10 bg-gray-50 border border-firstColor text-gray-900 text-base rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                                placeholder="Primer Apellido">
                                @if (authenticate.setError(formData.value.firstLastName, '') !== '' && formData.value.firstLastName !== '') {
                                    <p class="font-medium my-1 text-red-700" [innerHTML]="authenticate.setError(formData.value.firstLastName, '')"></p>
                                }
                        </div>
                        <div class="relative">
                            <label  
                                class="block mb-2 text-base font-medium text-gray-900">Segundo Apellido</label>
                            <img class="absolute left-2 top-10 w-6" src="../../../../assets/resources/Recurso 29.png" alt="">
                            <input type="text" formControlName="secondLastName"
                                class="pl-10 bg-gray-50 border border-firstColor text-gray-900 text-base rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                                placeholder="Segundo Apellido">
                                @if (authenticate.setError(formData.value.secondLastName, '') !== '' && formData.value.secondLastName !== '') {
                                    <p class="font-medium my-1 text-red-700" [innerHTML]="authenticate.setError(formData.value.secondLastName, '')"></p>
                                }
                        </div>
                        <div class="relative">
                            <label  
                                class="block mb-2 text-base font-medium text-gray-900">N° Celular</label>
                            <svg class="absolute left-2 top-11 w-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M3 5.5C3 14.0604 9.93959 21 18.5 21C18.8862 21 19.2691 20.9859 19.6483 20.9581C20.0834 20.9262 20.3009 20.9103 20.499 20.7963C20.663 20.7019 20.8185 20.5345 20.9007 20.364C21 20.1582 21 19.9181 21 19.438V16.6207C21 16.2169 21 16.015 20.9335 15.842C20.8749 15.6891 20.7795 15.553 20.6559 15.4456C20.516 15.324 20.3262 15.255 19.9468 15.117L16.74 13.9509C16.2985 13.7904 16.0777 13.7101 15.8683 13.7237C15.6836 13.7357 15.5059 13.7988 15.3549 13.9058C15.1837 14.0271 15.0629 14.2285 14.8212 14.6314L14 16C11.3501 14.7999 9.2019 12.6489 8 10L9.36863 9.17882C9.77145 8.93713 9.97286 8.81628 10.0942 8.64506C10.2012 8.49408 10.2643 8.31637 10.2763 8.1317C10.2899 7.92227 10.2096 7.70153 10.0491 7.26005L8.88299 4.05321C8.745 3.67376 8.67601 3.48403 8.55442 3.3441C8.44701 3.22049 8.31089 3.12515 8.15802 3.06645C7.98496 3 7.78308 3 7.37932 3H4.56201C4.08188 3 3.84181 3 3.63598 3.09925C3.4655 3.18146 3.29814 3.33701 3.2037 3.50103C3.08968 3.69907 3.07375 3.91662 3.04189 4.35173C3.01413 4.73086 3 5.11378 3 5.5Z" stroke="#F8DE22" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
                            <input type="text" inputmode="numeric" pattern="[0-9]*" oninput="this.value = this.value.replace(/[^0-9]/g, '');" formControlName="numberCell"
                                class="pl-10 bg-gray-50 border border-firstColor text-gray-900 text-base rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                                placeholder="N° Celular">
                        </div>
                        <div class="relative">
                            <label  
                                class="block mb-2 text-base font-medium text-gray-900">Email</label>
                            <img class="absolute left-2 top-12 w-6" src="../../../../assets/resources/Recurso 25.png" alt="">
                            <input type="email" formControlName="email"
                                class="pl-10 bg-gray-50 border border-firstColor text-gray-900 text-base rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                                placeholder="Emali">
                                @if (authenticate.setError(formData.value.email, 'e', formData.get('email')?.hasError('email')) !== '' && formData.value.email !== '') {
                                    <p class="font-medium my-1 text-red-700" [innerHTML]="authenticate.setError(formData.value.email, 'e', formData.get('email')?.hasError('email'))"></p>
                                }
                        </div>
                    </div>
                    <!-- Modal footer -->
                    <div class="min_oculy:flex items-center p-4 md:p-5 border-t border-gray-200 rounded-b">
                        <button
                            [disabled]="!formData.valid"
                            (click)="sendInfoUser()"
                            class="text-white bg-firstColor hover:opacity-85 focus:ring-4 focus:outline-none font-medium rounded-lg text-base px-5 py-2.5 text-center">
                            Actualizar Datos
                        </button>
                        <button (click)="ocult()"
                            class="py-2.5 px-5 ms-3 text-base font-medium text-gray-900 focus:outline-none bg-white hover:bg-gray-300 rounded-lg border border-gray-200">
                            Cancelar
                        </button>
                        @if (errorMessage !== [] || errorMessage !== undefined || !formData.valid) {
                            <div class="min_oculy:ml-10 min_oculy:mt-0 mt-5 text-base text-red-700">
                                @if (!formData.valid) {Datos Incompletos. <br>}
                                @for (men of errorMessage; track $index) { {{men}} <br> }
                            </div>
                        } 
                        @if (succes) {
                            <div class="min_oculy:ml-10 min_oculy:mt-0 mt-5 text-base text-green-500">
                                Guardada con éxito.
                            </div>
                        }
                    </div>
                </form>
            }
            @if (customer.showUpdatePassword) {
                <form class="p-4 md:p-5" novalidate [formGroup]="formPassword">
                    <div class="grid gap-4 mb-4 grid-cols-2">
                        <div class="relative">
                            <label  
                                class="block mb-2 text-base font-medium text-gray-900">Contraseña Nueva</label>
                            <img class="absolute left-2 top-10 w-6" src="../../../../assets/resources/PWIcon.png" alt="">
                            <input type="password" formControlName="password"
                                class="pl-10 bg-gray-50 border border-firstColor text-gray-900 text-base rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                                placeholder="Contraseña Nueva">
                                @if (authenticate.setError(formPassword.value.password, 'p') !== '' && formPassword.value.password !== '') {
                                    <p class="font-medium my-1 text-red-700" [innerHTML]="authenticate.setError(formPassword.value.password, 'p')"></p>
                                }
                        </div>
                        <div class="relative">
                            <label  
                                class="block mb-2 text-base font-medium text-gray-900">Confirme Contraseña</label>
                            <img class="absolute left-2 top-10 w-6" src="../../../../assets/resources/PWIcon.png" alt="">
                            <input type="password" formControlName="passwordConfirm"
                                class="pl-10 bg-gray-50 border border-firstColor text-gray-900 text-base rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                                placeholder="Confirme Contraseña">
                                @if (formPassword.value.password != formPassword.value.passwordConfirm && formPassword.value.passwordConfirm !== '') {
                                    <p class="font-medium my-1 text-red-700">Las contraseñas no coinciden</p>
                                }
                        </div>
                    </div>
                    <!-- Modal footer -->
                    <div class="min_oculy:flex items-center p-4 md:p-5 border-t border-gray-200 rounded-b">
                        <button
                            [disabled]="!formPassword.valid"
                            (click)="sendPassword()"
                            class="text-white bg-firstColor hover:opacity-85 focus:ring-4 focus:outline-none font-medium rounded-lg text-base px-5 py-2.5 text-center">
                            Actualizar Contraseña
                        </button>
                        <button (click)="ocult()"
                            class="py-2.5 px-5 ms-3 text-base font-medium text-gray-900 focus:outline-none bg-white hover:bg-gray-300 rounded-lg border border-gray-200">
                            Cancelar
                        </button>
                        @if (errorMessage !== [] || errorMessage !== undefined || !formPassword.valid) {
                            <div class="min_oculy:ml-10 min_oculy:mt-0 mt-5 text-base text-red-700">
                                @if (!formPassword.valid) {Datos Incompletos. <br>}
                                @for (men of errorMessage; track $index) { {{men}} <br> }
                            </div>
                        } 
                        @if (succes) {
                            <div class="min_oculy:ml-10 min_oculy:mt-0 mt-5 text-base text-green-500">
                                Guardada con éxito.
                            </div>
                        }
                    </div>
                </form>
            }
            @if (customer.showAddCard) {
                <form class="p-4 md:p-5" novalidate [formGroup]="formCard">
                    <div class="grid gap-4 mb-4 grid-cols-2">
                        <div class="relative">
                            <label  
                                class="block mb-2 text-base font-medium text-gray-900">Nombre del propietario</label>
                            <img class="absolute left-2 top-10 w-6" src="../../../../assets/resources/Recurso 29.png" alt="">
                            <input type="text" formControlName="nameProp"
                                class="pl-10 bg-gray-50 border border-firstColor text-gray-900 text-base rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                                placeholder="Nombre del propietario">
                        </div>
                        <div class="relative">
                            <label  
                                class="block mb-2 text-base font-medium text-gray-900">Número de tarjeta</label>
                                <img class="absolute left-2 top-12 w-6" src="../../../../assets/resources/Recurso 32.png" alt="">
                            <input type="text" inputmode="numeric" pattern="[0-9]*" oninput="this.value = this.value.replace(/[^0-9]/g, '');" formControlName="numberCard"
                                class="pl-10 bg-gray-50 border border-firstColor text-gray-900 text-base rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:focus:ring-primary-500 dark:focus:border-primary-500"
                                placeholder="Número de tarjeta">
                        </div>
                        <div>
                            <label for="name" class="block mb-2 text-base font-medium text-gray-900">Fecha de vencimiento</label>
                            <input type="date" formControlName="dateExpiration"
                                class="bg-gray-50 border border-firstColor text-gray-900 text-base rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"
                                placeholder="Type product name" required="">
                        </div>
                        <div class="relative">
                            <label  
                                class="block mb-2 text-base font-medium text-gray-900">CVV</label>
                                <img class="absolute left-2 top-12 w-6" src="../../../../assets/resources/Recurso 32.png" alt="">
                            <input type="text" inputmode="numeric" pattern="[0-9]*" oninput="this.value = this.value.replace(/[^0-9]/g, '');" formControlName="csv"
                                class="pl-10 bg-gray-50 border border-firstColor text-gray-900 text-base rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"
                                placeholder="CVV">
                        </div>
                        <div class="relative">
                            <label  
                                class="block mb-2 text-base font-medium text-gray-900">Tipo de Tajeta</label>
                                <img class="absolute left-2 top-12 w-6" src="../../../../assets/resources/Recurso 32.png" alt="">
                            <select id="category" formControlName="typeCard" (change)="selectTypeCard($event)"
                                class="bg-gray-50 border border-firstColor text-gray-900 text-base rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5">
                                <option class="text-center text-base font-medium" value="3">American Express</option>
                                <option class="text-center text-base font-medium" value="4">Visa</option>
                                <option class="text-center text-base font-medium" value="5">Mastercard</option>
                                <option class="text-center text-base font-medium" value="6">Discover</option>
                            </select>
                        </div>
                    </div>
                    <!-- Modal footer -->
                    <div class="min_oculy:flex items-center p-4 md:p-5 border-t border-gray-200 rounded-b">
                        <button
                            [disabled]="!formCard.valid"
                            (click)="sendCard()"
                            class="text-white bg-firstColor hover:opacity-85 focus:ring-4 focus:outline-none font-medium rounded-lg text-base px-5 py-2.5 text-center">
                            Guardar tarjeta
                        </button>
                        <button (click)="ocult()"
                            class="py-2.5 px-5 ms-3 text-base font-medium text-gray-900 focus:outline-none bg-white hover:bg-gray-300 rounded-lg border border-gray-200">
                            Cancelar
                        </button>
                        @if (errorMessage !== [] || errorMessage !== undefined || !formCard.valid) {
                            <div class="min_oculy:ml-10 min_oculy:mt-0 mt-5 text-base text-red-700">
                                @if (!formCard.valid) {Datos Incompletos. <br>}
                                @for (men of errorMessage; track $index) { {{men}} <br> }
                            </div>
                        } 
                        @if (succes) {
                            <div class="min_oculy:ml-10 min_oculy:mt-0 mt-5 text-base text-green-500">
                                Guardada con éxito.
                            </div>
                        }
                    </div>
                </form>
            }
        </div>
    </div>
</div>